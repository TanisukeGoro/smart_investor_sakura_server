from module.progress import progress_bar
from dateutil.parser import parse
from datetime import datetime
import time, os, json, requests, sys, io, re
from bs4 import BeautifulSoup as bs
import pandas as pd

report_db = '/Users/abekeishi/code/gs_team_dev_repositry/src/report_db.csv'
tmp_csv = pd.read_csv(report_db)
tmp_columns = list(tmp_csv.columns)
report_df = pd.DataFrame([], columns=tmp_columns)

test_debug=[{'docID': 'S10050GM', 'campany_no': None, 'year': 2011, 'series_data': None, 'filerName': '株式会社コーエーテクモホールディングス', 'edinetCode': 'E22460', 'NetSales': 32081000000, 'OrdinaryIncomeLoss': 4788000000, 'ProfitLoss': None, 'NetAssets': 69761000000, 'tAssets': 77487000000, 'psNetAssets': 803.37, 'psBasicEarningsLoss': 31.62, 'ROE': 0.039, 'cfOperating': 5077000000, 'cfInvesting': -2074000000, 'cfFinancing': -1085000000, 'CashEquivalents': 10779000000, 'tIssuedShares': 89769479, 'Capex': None, 'Inventories': None, 'GrossProfit': None, 'OperatingProfit': None, 'Depreciation': None, 'acReceivable': None, 'acPayable': None, 'stBonds': None, 'stLoans': None, 'CP': None, 'cpBonds': None, 'cpLoans': None, 'Bonds': None, 'ltLoans': None, 'ShareholdersEquity': None, 'Valuation': None, 'disclosureStatusFlg': 0, 'xbrlFlg': 1, 'RequestFlg': None, 'ParseFlg': None, 'season': 2}, {'docID': 'S10050GM', 'campany_no': None, 'year': 2012, 'series_data': None, 'filerName': '株式会社コーエーテクモホールディングス', 'edinetCode': 'E22460', 'NetSales': 35525000000, 'OrdinaryIncomeLoss': 7472000000, 'ProfitLoss': None, 'NetAssets': 70414000000, 'tAssets': 80746000000, 'psNetAssets': 811.56, 'psBasicEarningsLoss': 53.52, 'ROE': 0.066, 'cfOperating': 7115000000, 'cfInvesting': -8970000000, 'cfFinancing': -2392000000, 'CashEquivalents': 6528000000, 'tIssuedShares': 89769479, 'Capex': None, 'Inventories': None, 'GrossProfit': None, 'OperatingProfit': None, 'Depreciation': None, 'acReceivable': None, 'acPayable': None, 'stBonds': None, 'stLoans': None, 'CP': None, 'cpBonds': None, 'cpLoans': None, 'Bonds': None, 'ltLoans': None, 'ShareholdersEquity': None, 'Valuation': None, 'disclosureStatusFlg': 0, 'xbrlFlg': 1, 'RequestFlg': None, 'ParseFlg': None, 'season': 3}, {'docID': 'S10050GM', 'campany_no': None, 'year': 2013, 'series_data': None, 'filerName': '株式会社コーエーテクモホールディングス', 'edinetCode': 'E22460', 'NetSales': 34639000000, 'OrdinaryIncomeLoss': 8835000000, 'ProfitLoss': None, 'NetAssets': 81623000000, 'tAssets': 95010000000, 'psNetAssets': 939.52, 'psBasicEarningsLoss': 65.23, 'ROE': 0.074, 'cfOperating': 12170000000, 'cfInvesting': -2079000000, 'cfFinancing': -1994000000, 'CashEquivalents': 15107000000, 'tIssuedShares': 89769479, 'Capex': None, 'Inventories': None, 'GrossProfit': None, 'OperatingProfit': None, 'Depreciation': None, 'acReceivable': None, 'acPayable': None, 'stBonds': None, 'stLoans': None, 'CP': None, 'cpBonds': None, 'cpLoans': None, 'Bonds': None, 'ltLoans': None, 'ShareholdersEquity': None, 'Valuation': None, 'disclosureStatusFlg': 0, 'xbrlFlg': 1, 'RequestFlg': None, 'ParseFlg': None, 'season': 4}, {'docID': 'S10050GM', 'campany_no': None, 'year': 2014, 'series_data': None, 'filerName': '株式会社コーエーテクモホールディングス', 'edinetCode': 'E22460', 'NetSales': 37576000000, 'OrdinaryIncomeLoss': 10728000000, 'ProfitLoss': None, 'NetAssets': 88788000000, 'tAssets': 100622000000, 'psNetAssets': 1020.7, 'psBasicEarningsLoss': 79.86, 'ROE': 0.081, 'cfOperating': 7265000000, 'cfInvesting': -8585000000, 'cfFinancing': -2787000000, 'CashEquivalents': 11764000000, 'tIssuedShares': 89769479, 'Capex': None, 'Inventories': 273000000, 'GrossProfit': 16150000000, 'OperatingProfit': 7140000000, 'Depreciation': None, 'acReceivable': 8755000000, 'acPayable': 1413000000, 'stBonds': None, 'stLoans': None, 'CP': None, 'cpBonds': None, 'cpLoans': None, 'Bonds': None, 'ltLoans': None, 'ShareholdersEquity': 86535000000, 'Valuation': 2199000000, 'disclosureStatusFlg': 0, 'xbrlFlg': 1, 'RequestFlg': None, 'ParseFlg': None, 'season': 5}, {'docID': 'S10050GM', 'campany_no': None, 'year': 2015, 'series_data': '第６期（自\u3000平成26年４月１日\u3000至\u3000平成27年３月31日）', 'filerName': '株式会社コーエーテクモホールディングス（旧会社名\u3000コーエーテクモホールディングス株式会社）', 'edinetCode': 'E22460', 'NetSales': 37799000000, 'OrdinaryIncomeLoss': 13568000000, 'ProfitLoss': None, 'NetAssets': 100672000000, 'tAssets': 115216000000, 'psNetAssets': 1149.11, 'psBasicEarningsLoss': 108.35, 'ROE': 0.1, 'cfOperating': 10357000000, 'cfInvesting': -7579000000, 'cfFinancing': -3045000000, 'CashEquivalents': 11874000000, 'tIssuedShares': 89769479, 'Capex': None, 'Inventories': 14000000, 'GrossProfit': 17102000000, 'OperatingProfit': 9652000000, 'Depreciation': None, 'acReceivable': 9734000000, 'acPayable': 2338000000, 'stBonds': None, 'stLoans': None, 'CP': None, 'cpBonds': None, 'cpLoans': None, 'Bonds': None, 'ltLoans': None, 'ShareholdersEquity': 92919000000, 'Valuation': 7672000000, 'disclosureStatusFlg': 0, 'xbrlFlg': 1, 'RequestFlg': None, 'ParseFlg': None, 'season': 6}]
report_df = pd.concat([report_df, pd.DataFrame.from_dict(test_debug)], sort=True)
report_df.to_csv('EDINET_DB_debug.csv', mode='a', header=False)
